# TextEditor设计文档
- 项目简介
- 需求分析
- 设计架构

## 项目简介
TextEditor是一款运行于Android上免费、永无广告的富文本编辑器，功能丰富，界面简洁，且代码开源，有利于后期维护。内核使用的是ace，编译项目前需先编译ace 内核。
  
## 需求分析  
TextEditor参考市面上较为流行的富文本编辑器功能，基本能够满足所有用户常用的功能。
首先界面设计，顶部横向排列菜单栏，根据不同功能分类分别为：文件、编辑、查找、查看、其它，每个分类下拉列表包含此类子功能，如新建、打开、保存、复制、粘贴、查找替换、高亮、插入颜色等。菜单栏下部为标题栏和文本编辑面板，支持同时打开多个文本，点击标题栏可快速切换，支持代码文本的语法高亮，显示行号，更改字体和字号等。
  
## 设计架构
  - 项目根据不同的功能分区，主要由五部分组成，分别为主界面、文件浏览选择界面以及三个辅助工具包。
  - 主界面（包app），实现整体界面框架，以及顶部菜单栏和文本编辑面板的大部分功能，部分功能通过调用其它包内的工具类实现。富文本编辑器是通过WebView控件来实现的，通过对基本配置，如访问权限、编码格式、字体、缓存、网络请求等的设置，完成基本展示功能。由于文本输入需要获取系统当前输入法处理后输出的内容，需要继承系统类InputConnection，重写其中的方法，获取到用户输入内容后，通过WebView展示，并做相应的自定义修改。
  - 文件浏览界面（包file_explorer），用户使用打开或另存为功能时，通过请求访问本地存储的权限，此界面可以显示本地存储目录结构，用户可自由选择目标文件和目录，支持打开本地文件和文件另存为功能。
  - 辅助工具包分别支持应用异常退出时的日志抓取和展示（包common），多种数据格式之间的转换（包tools），以及对应用自定义配置信息的保存（包styles）。
  - ![](https://github.com/openthos/systemui-analysis/blob/master/ImageView/TextEditor.png)
